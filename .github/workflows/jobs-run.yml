name: Extract variables and run jobs

on:
  push:
    branches: [main]

jobs:
  extract:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v2

    - name: Install jq
      run: sudo apt-get update && sudo apt-get install -y jq

    - name: JSON to variables
      uses: rgarcia-phi/json-to-variables@v1.1.0
      with:
        filename: 'repos.json'
        prefix: test
        masked: false
    - name: Show output details
      run: |
        echo job1 valuse : ${{ env.test_job1 }}
        echo job2 valuse : ${{ env.test_job2 }}
        echo job3 valuse : ${{ env.test_job3 }}
        echo job4 valuse : ${{ env.test_job4 }}
    
    - name: Show output details job1
      if: ${{ env.test_job1 }} == 'true'
      run: |
        echo job1 valuse : ${{ env.test_job1 }}

    - name: Show output details job2
      if: ${{ env.test_job2 }} == 'true'
      run: |
        echo job2 valuse : ${{ env.test_job2 }}
    - name: Show output details job3
      if: ${{ env.test_job3 }} == 'false'
      run: |
        echo job3 valuse : ${{ env.test_job3 }}        
